
WITH CTE AS(
SELECT
    driver_id,
    --CUR_VEHICLE AS VEHICLE_TYPE,
    CUR_ZONE AS ZONE_CODE,
    SUM(HOURS_WORKED) AS RAC_HOURS_WORKED,
    SUM(ORDERS_DELIVERED) AS RAC_ORDERS_DELIVERED
FROM production.denormalised.driver_accounting_daily
WHERE DATE BETWEEN '2024-10-24' AND '2024-11-03'
    AND CUR_COUNTRY = 'UK'
    GROUP BY 1,2
    ORDER BY 1,2
)
SELECT 
  A.DRIVER_ID,
 --VEHICLE_TYPE,
  CITY_NAME AS "City", 
  A.ZONE_CODE AS "Zone",
  RAC_HOURS_WORKED,
  COUNT(STATUS) AS ORDER_COUNT,
  RAC_ORDERS_DELIVERED

FROM PRODUCTION.denormalised.orders A
LEFT JOIN CTE ON CTE.driver_id = A.DRIVER_ID AND CTE.ZONE_CODE = A.ZONE_CODE
  WHERE COUNTRY_NAME IN ('UK', 'Ireland')
  AND STATUS = 'DELIVERED'  
  AND DATE(LOCAL_TIME_OA_CREATED_AT) BETWEEN '2024-10-24' AND '2024-11-03'
  AND A.DRIVER_ID IN

        ('520157',
        '908649',
        '919871',
        '728237',
        '302920',
        '415242',
        '424755',
        '449414',
        '603968',
        '545118',
        '587050',
        '350051',
        '664906',
        '734315',
        '564551',
        '775457',
        '604940',
        '456169',
        '899394',
        '819634',
        '457476',
        '393361',
        '473514',
        '916359',
        '917081',
        '138431',
        '870740',
        '603827',
        '517597',
        '548766',
        '83922',
        '792210',
        '356935',
        '919620',
        '870917',
        '834284',
        '650860',
        '294894',
        '592921',
        '914461',
        '455172',
        '481033',
        '760219',
        '607787',
        '733796',
        '541429',
        '668812',
        '883015',
        '6859',
        '729981',
        '916244',
        '447191',
        '182790',
        '358801',
        '236451',
        '407662',
        '812245',
        '875933',
        '603678',
        '926216',
        '590503',
        '813923',
        '167515',
        '126535',
        '428479',
        '905735',
        '518291',
        '871107',
        '428480',
        '656476',
        '639866',
        '903667',
        '452774',
        '224656',
        '162841',
        '653650',
        '826630',
        '922998',
        '718152',
        '417930',
        '382319',
        '837954',
        '235969',
        '813429',
        '412837',
        '656164',
        '440419',
        '478427',
        '602566',
        '826061',
        '737140',
        '428435',
        '413081',
        '661606',
        '157054',
        '878918',
        '431043',
        '237573',
        '692381',
        '480780',
        '714840',
        '808602',
        '833815',
        '440639',
        '284455',
        '718102',
        '169066',
        '447249',
        '395888',
        '429429',
        '349150',
        '909087',
        '154600',
        '641036',
        '250296',
        '621126',
        '927525',
        '232190',
        '872531',
        '528539',
        '524667',
        '877752',
        '548376',
        '765601',
        '90308',
        '595756',
        '719632',
        '586923',
        '702973',
        '871079',
        '487993',
        '886013',
        '171505',
        '262029',
        '543271',
        '211786',
        '757319',
        '658390',
        '65302',
        '706916',
        '381418',
        '248273',
        '391890',
        '774118',
        '901691',
        '891758',
        '533726',
        '466270',
        '620514',
        '646698',
        '903631',
        '842778',
        '783725',
        '561695',
        '891626',
        '651083',
        '873384',
        '58125',
        '603796',
        '533911',
        '822660',
        '821775',
        '767331',
        '714965',
        '303038',
        '376131',
        '645522',
        '359528',
        '872508',
        '649348',
        '568519',
        '524198',
        '605878',
        '762266',
        '394423',
        '784913',
        '634321',
        '595610',
        '655527',
        '741432',
        '916364',
        '702918',
        '899024',
        '599337',
        '436368',
        '451383',
        '906262',
        '336463',
        '238267',
        '684681',
        '756134',
        '84490',
        '782915',
        '183461',
        '239587',
        '918301',
        '748207',
        '882595',
        '666942',
        '761695',
        '381051',
        '768135',
        '356838',
        '415880',
        '746223',
        '394471',
        '393217',
        '628740',
        '415551',
        '691966',
        '833040',
        '768654',
        '818407',
        '833119',
        '243008',
        '358830',
        '870290',
        '226902',
        '222391',
        '915705',
        '851031',
        '928778',
        '308577',
        '906495',
        '623747',
        '635433',
        '863878',
        '878750',
        '450418',
        '668045',
        '907537',
        '891265',
        '646305',
        '549602',
        '345210',
        '766001',
        '637012',
        '350092',
        '665217',
        '601479',
        '432756',
        '884912',
        '928425',
        '850695',
        '478228',
        '645657',
        '264309',
        '476498',
        '834279',
        '874886',
        '889213',
        '896167',
        '320201',
        '569839',
        '884639',
        '534260',
        '265884',
        '825294',
        '491794',
        '905553',
        '872819',
        '471853',
        '439141',
        '877233',
        '424878',
        '910752',
        '167125',
        '811768',
        '881911',
        '543261',
        '394283',
        '710521',
        '859793',
        '603363',
        '572331',
        '437063',
        '603705',
        '820190',
        '902663',
        '901299',
        '856862',
        '792909',
        '797408',
        '184583',
        '174094',
        '745115',
        '906823',
        '783681',
        '30604',
        '878869',
        '247206',
        '878995',
        '61983',
        '713266',
        '147015',
        '418916',
        '144203',
        '357616',
        '907481',
        '601655',
        '738556',
        '906337',
        '591509',
        '419113',
        '838553',
        '474031',
        '634116',
        '901850',
        '922825',
        '410672',
        '926867',
        '539734',
        '393102',
        '891623',
        '876519',
        '548156',
        '767304',
        '811006',
        '868765',
        '139844',
        '204666',
        '839414',
        '620149',
        '854366',
        '593088',
        '390570',
        '819187',
        '660341',
        '808373',
        '893395',
        '871916',
        '483906',
        '413399',
        '428709',
        '405848',
        '909502',
        '553097',
        '833215',
        '396733',
        '440179',
        '222642',
        '422604',
        '737942',
        '687953',
        '847825',
        '877480',
        '94285',
        '293774',
        '729361',
        '455324',
        '917509',
        '441556',
        '691916',
        '720268',
        '791334',
        '821795',
        '893284',
        '893382',
        '713505',
        '347552',
        '567907',
        '905760',
        '515348',
        '520185',
        '919729',
        '882170',
        '812366',
        '356540',
        '660664',
        '479664',
        '870519',
        '779343',
        '330647',
        '546690',
        '857271',
        '165974',
        '349934',
        '345152',
        '200303',
        '513187',
        '549541',
        '359425',
        '601585',
        '926110',
        '607533',
        '831569',
        '782886',
        '870738',
        '899768',
        '628152',
        '731056',
        '919347',
        '614848',
        '608929',
        '708618',
        '330710',
        '824248',
        '917573',
        '433761',
        '874414',
        '849068',
        '879571',
        '876375',
        '791581',
        '586632',
        '853975',
        '794264',
        '896900',
        '418711',
        '812874',
        '918208',
        '887540',
        '903523',
        '422601',
        '414178',
        '547124',
        '614360',
        '732400',
        '595552',
        '867978',
        '135868',
        '786030',
        '623900',
        '649873',
        '913324',
        '755506',
        '856645',
        '765442',
        '483572',
        '919753',
        '493349',
        '838732',
        '375256',
        '715215',
        '898172',
        '922877',
        '342443',
        '419441',
        '917565',
        '404298',
        '905289',
        '375103',
        '701699',
        '619584',
        '336945',
        '775796',
        '547459',
        '816705',
        '818803',
        '900009',
        '919301',
        '626811',
        '872817',
        '777954',
        '838393',
        '555810',
        '811262',
        '552871',
        '313662',
        '654636',
        '515897',
        '849429',
        '904282',
        '895930',
        '356842',
        '509214',
        '406611',
        '890917',
        '679680',
        '305769',
        '182757',
        '460358',
        '512445',
        '808323',
        '393930',
        '835651',
        '838994',
        '647351',
        '763102',
        '623773',
        '453524',
        '469829',
        '559000',
        '380956',
        '450554',
        '667984',
        '819594',
        '449463',
        '888712',
        '352732',
        '705637',
        '642432',
        '855431',
        '833413',
        '606501',
        '878775',
        '1806',
        '809972',
        '386985',
        '475636',
        '513685',
        '519142',
        '837642',
        '878824',
        '868441',
        '456193',
        '514212',
        '446900',
        '607272',
        '923676',
        '637532',
        '164891',
        '893648',
        '811106',
        '902648',
        '378309',
        '626305',
        '908201',
        '848881',
        '824589',
        '611678',
        '487970',
        '775146',
        '905903',
        '173729',
        '516710',
        '594262',
        '907459',
        '817238',
        '550331',
        '893759',
        '491011',
        '715513',
        '608166',
        '901583',
        '429603',
        '684041',
        '817862',
        '417360',
        '347821',
        '161706',
        '426316',
        '448453',
        '929186',
        '652590',
        '606812',
        '172339',
        '769542',
        '552408',
        '765984',
        '832578',
        '850940',
        '417496',
        '905915',
        '597846',
        '419792',
        '704719',
        '710558',
        '767774',
        '891719',
        '480040',
        '645752',
        '923621',
        '606166',
        '623524',
        '357197',
        '871530',
        '523638',
        '406514',
        '744524',
        '545390',
        '428603',
        '61805',
        '907802',
        '704781',
        '429678',
        '833167',
        '506688',
        '312622',
        '408705',
        '651288',
        '638333',
        '772349',
        '851231',
        '849608',
        '847965',
        '748164',
        '817448',
        '849337',
        '918513',
        '813947',
        '919697',
        '448685',
        '773448',
        '891737',
        '542134',
        '480435',
        '524306',
        '745243',
        '179965',
        '906318',
        '657798',
        '112807',
        '926151',
        '717931',
        '826187',
        '516774',
        '777780',
        '384184',
        '422542',
        '909816',
        '481337',
        '846992',
        '876071',
        '565187',
        '442719',
        '756879',
        '548070',
        '864832',
        '899560',
        '692525',
        '479671',
        '877219',
        '914366',
        '609220',
        '598256',
        '619880',
        '592987',
        '623779',
        '62310',
        '100693',
        '633235',
        '660358',
        '243503',
        '636174',
        '247614',
        '234419',
        '666539',
        '655411',
        '646845',
        '247281',
        '688501',
        '681082',
        '655334',
        '660633',
        '683737',
        '677322',
        '332755',
        '334141',
        '693497',
        '352499',
        '347475',
        '355691',
        '744703',
        '725732',
        '745188',
        '347162',
        '751675',
        '394346',
        '359816',
        '777890',
        '378166',
        '396183',
        '384574',
        '763100',
        '779592',
        '779085',
        '410069',
        '411623',
        '815341',
        '818039',
        '814870',
        '415792',
        '827131',
        '828773',
        '419963',
        '420508',
        '82465',
        '430692',
        '427222',
        '442705',
        '431048',
        '833652',
        '433945',
        '848764',
        '844697',
        '436486',
        '845548',
        '448394',
        '845224',
        '844084',
        '864810',
        '869596',
        '870642',
        '476622',
        '876045',
        '485885',
        '874970',
        '484623',
        '878602',
        '878301',
        '883696',
        '883436',
        '523385',
        '508702',
        '895885',
        '895934',
        '523425',
        '903522',
        '896825',
        '902101',
        '545233',
        '537476',
        '552033',
        '562273',
        '913770',
        '564352',
        '568905',
        '587393',
        '913776',
        '924371',
        '921664',
        '923664',
        '924860',
        '596261',
        '621204',
        '600428',
        '600277',
        '600394',
        '149248',
        '16238',
        '175714',
        '644564',
        '645537',
        '170949',
        '145372',
        '237551',
        '669137',
        '68621',
        '665394',
        '658340',
        '667159',
        '238114',
        '314049',
        '690648',
        '698739',
        '699966',
        '675376',
        '680546',
        '715887',
        '705388',
        '713428',
        '325219',
        '334757',
        '333263',
        '332077',
        '336151',
        '734357',
        '357454',
        '360739',
        '751308',
        '753391',
        '757895',
        '753782',
        '390892',
        '391691',
        '755565',
        '796400',
        '773239',
        '773211',
        '773497',
        '401580',
        '810736',
        '777805',
        '782661',
        '410466',
        '781493',
        '796347',
        '817006',
        '811008',
        '811054',
        '815509',
        '809480',
        '820763',
        '818108',
        '825602',
        '424477',
        '423017',
        '608991',
        '605770',
        '603124',
        '843631',
        '620980',
        '844600',
        '439329',
        '604822',
        '444655',
        '615733',
        '604794',
        '631655',
        '624036',
        '173999',
        '121606',
        '438951',
        '163105',
        '629650',
        '631567',
        '637561',
        '636648',
        '641546',
        '632176',
        '63873',
        '650026',
        '662097',
        '269641',
        '268824',
        '65278',
        '675102',
        '682893',
        '864379',
        '675664',
        '682711',
        '457493',
        '675868',
        '289124',
        '321434',
        '319714',
        '703985',
        '483681',
        '696818',
        '871215',
        '701117',
        '330116',
        '345510',
        '342975',
        '337443',
        '346700',
        '740864',
        '345640',
        '487551',
        '486517',
        '874032',
        '876110',
        '877694',
        '875942',
        '891504',
        '879965',
        '749222',
        '507520',
        '764475',
        '505143',
        '759698',
        '381244',
        '384571',
        '758202',
        '758687',
        '498338',
        '782166',
        '896151',
        '773343',
        '771569',
        '894896',
        '775900',
        '410435',
        '808331',
        '412487',
        '813086',
        '427610',
        '819475',
        '819499',
        '826841',
        '828603',
        '834297',
        '421720',
        '903118',
        '431527',
        '436436',
        '838993',
        '438510',
        '438646',
        '429910',
        '845359',
        '850319',
        '845318',
        '445517',
        '846243',
        '864563',
        '863654',
        '468176',
        '451963',
        '524729',
        '863894',
        '869788',
        '528575',
        '876676',
        '874280',
        '878292',
        '488536',
        '884706',
        '880628',
        '880775',
        '528253',
        '903960',
        '507567',
        '518333',
        '507322',
        '899023',
        '541',
        '534255',
        '542738',
        '553203',
        '905256',
        '548093',
        '910004',
        '567865',
        '908121',
        '571291',
        '560882',
        '565241',
        '912670',
        '587562',
        '916580',
        '540675',
        '919810',
        '546667',
        '546821',
        '905976',
        '906496',
        '555826',
        '908441',
        '908224',
        '908103',
        '910228',
        '911490',
        '911986',
        '556285',
        '559355',
        '569795',
        '572328',
        '585771',
        '591943',
        '59235',
        '5924',
        '913806',
        '922070',
        '925182',
        '930307',
        '929028',
        '630890',
        '658471',
        '592927',
        '620819',
        '635226',
        '627722',
        '636690',
        '613146',
        '636353',
        '595158',
        '634717',
        '603779',
        '628923',
        '714921',
        '299278',
        '660584',
        '298435',
        '660554',
        '219013',
        '225377',
        '717514',
        '224461',
        '696159',
        '194063',
        '359357',
        '675256',
        '706006',
        '70104',
        '665534',
        '729668',
        '678372',
        '331998',
        '812264',
        '827753',
        '748712',
        '777603',
        '765411',
        '426463',
        '783722',
        '811023',
        '414458',
        '380746',
        '725356',
        '402362',
        '808695',
        '404639',
        '428331',
        '854144',
        '844636',
        '839127',
        '874703',
        '816235',
        '810725',
        '595159',
        '845745',
        '829172',
        '599996',
        '833218',
        '873337',
        '426586',
        '486220',
        '869136',
        '600328',
        '839214',
        '861898',
        '818749',
        '456787',
        '426825',
        '427958',
        '617353',
        '466288',
        '517834',
        '880346',
        '896866',
        '886803',
        '907522',
        '602538',
        '621818',
        '106335',
        '517071',
        '898615',
        '553517',
        '876133',
        '533637',
        '906929',
        '536138',
        '593791',
        '467633',
        '910475',
        '929313',
        '623024',
        '925978',
        '927180',
        '613775',
        '171272',
        '545229',
        '917096',
        '544974',
        '620343',
        '627095',
        '909680',
        '925860',
        '912748',
        '916579',
        '614422',
        '556822',
        '148430',
        '552607',
        '918974',
        '925155',
        '620018',
        '917637',
        '611705',
        '609718',
        '615134',
        '102958',
        '612345',
        '614261',
        '927914',
        '609672',
        '609681',
        '631373',
        '105421',
        '108920',
        '145538',
        '637002',
        '103538',
        '640629',
        '642623',
        '640532',
        '640628',
        '634776',
        '220012',
        '657433',
        '659411',
        '630042',
        '196276',
        '657271',
        '209537',
        '630180',
        '631741',
        '632667',
        '680629',
        '630664',
        '632007',
        '653397',
        '207652',
        '684510',
        '244105',
        '648994',
        '669141',
        '193195',
        '192338',
        '199901',
        '211458',
        '197235',
        '691595',
        '200875',
        '650098',
        '184605',
        '658564',
        '332780',
        '194563',
        '224428',
        '326195',
        '316150',
        '652617',
        '698221',
        '670304',
        '673376',
        '681425',
        '689649',
        '327234',
        '677328',
        '672766',
        '682434',
        '686957',
        '680743',
        '678907',
        '678105',
        '676979',
        '683867',
        '723413',
        '351191',
        '689242',
        '698344',
        '673764',
        '345638',
        '338228',
        '731308',
        '676261',
        '726331',
        '674288',
        '310733',
        '290475',
        '353039',
        '729314',
        '748838',
        '761604',
        '395535',
        '748824',
        '700429',
        '336878',
        '372328',
        '387020',
        '341707',
        '758466',
        '339426',
        '755455',
        '671220',
        '762681',
        '378608',
        '317786',
        '670361',
        '347157',
        '771042',
        '714149',
        '762911',
        '817949',
        '408058',
        '288885',
        '27986',
        '789395',
        '816014',
        '714709',
        '303675',
        '815753',
        '283363',
        '417423',
        '290581',
        '337302',
        '814607',
        '773577',
        '291779',
        '771963',
        '291112',
        '419350',
        '300896',
        '694590',
        '430059',
        '828422',
        '838378',
        '704488',
        '699324',
        '822590',
        '699664',
        '696120',
        '696705',
        '818882',
        '425629',
        '84439',
        '818962',
        '694076',
        '822019',
        '459947',
        '848761',
        '856321',
        '828749',
        '845873',
        '348370',
        '460422',
        '743279',
        '871121',
        '857357',
        '725563',
        '739985',
        '338220',
        '339518',
        '470916',
        '739933',
        '344859',
        '463959',
        '898856',
        '864241',
        '872323',
        '456956',
        '338330',
        '337357',
        '880655',
        '874023',
        '879764',
        '745288',
        '487048',
        '740002',
        '874309',
        '875226',
        '877318',
        '875183',
        '875781',
        '723741',
        '722297',
        '742453',
        '746280',
        '510584',
        '903133',
        '721340',
        '722304',
        '892391',
        '729602',
        '893991',
        '730829',
        '742076',
        '726048',
        '725898',
        '748299',
        '895313',
        '728839',
        '500043',
        '907868',
        '905557',
        '905631',
        '530682',
        '909391',
        '910643',
        '915849',
        '915075',
        '586890',
        '567867',
        '584419',
        '584424',
        '764751',
        '913980',
        '911433',
        '921947',
        '753766',
        '37512',
        '366764',
        '758028',
        '751757',
        '360425',
        '359771',
        '920976',
        '361340',
        '378356',
        '363061',
        '376119',
        '366052',
        '920324',
        '365890',
        '759211',
        '748812',
        '757117',
        '359656',
        '773009',
        '781259',
        '775697',
        '775305',
        '410420',
        '413230',
        '770989',
        '771952',
        '407676',
        '770663',
        '771255',
        '770017',
        '783390',
        '772740',
        '770840',
        '773467',
        '772008',
        '410379',
        '401756',
        '786585',
        '792214',
        '416209',
        '786268',
        '402157',
        '397973',
        '809981',
        '810249',
        '417835',
        '404645',
        '787722',
        '408141',
        '418096',
        '811263',
        '788813',
        '402153',
        '807985',
        '396796',
        '808753',
        '808326',
        '830120',
        '817898',
        '818822',
        '823975',
        '429328',
        '422645',
        '827159',
        '818211',
        '826726',
        '816927',
        '817236',
        '426585',
        '818144',
        '822077',
        '426350',
        '446015',
        '817023',
        '816954',
        '428492',
        '816844',
        '422392',
        '423753',
        '420238',
        '852827',
        '424089',
        '423811',
        '419720',
        '834140',
        '827190',
        '420564',
        '829585',
        '828776',
        '830776',
        '832622',
        '827276',
        '833668',
        '829356',
        '421061',
        '829393',
        '424777',
        '854864',
        '854221',
        '833273',
        '849174',
        '843463',
        '868321',
        '439609',
        '439841',
        '860891',
        '843477',
        '436328',
        '872483',
        '847710',
        '871337',
        '864607',
        '843529',
        '846912',
        '460908',
        '866799',
        '867941',
        '859774',
        '860722',
        '857617',
        '859031',
        '863647',
        '476278',
        '863876',
        '864625',
        '466180',
        '476616',
        '468000',
        '465490',
        '873238',
        '471714',
        '470292',
        '877879',
        '875218',
        '465891',
        '480205',
        '872907',
        '463158',
        '873845',
        '873085',
        '874291',
        '874836',
        '875223',
        '872881',
        '874744',
        '879706',
        '506568',
        '891717',
        '882878',
        '881539',
        '886857',
        '880842',
        '891734',
        '892916',
        '881203',
        '884504',
        '887026',
        '880556',
        '884612',
        '499329',
        '508757',
        '896155',
        '897142',
        '513640',
        '903758',
        '495858',
        '497995',
        '510933',
        '904294',
        '903306',
        '900362',
        '895108',
        '497579',
        '901555',
        '893761',
        '900114',
        '896132',
        '896641',
        '905106',
        '905300',
        '904371',
        '542811',
        '532383',
        '542445',
        '538577',
        '904890',
        '905519',
        '562369',
        '563239',
        '558331',
        '566228',
        '566553',
        '565925',
        '557507',
        '914671',
        '567324',
        '916469',
        '912596',
        '569191',
        '915221',
        '564532',
        '913775',
        '912563',
        '914480',
        '920678',
        '925148',
        '915753',
        '912951',
        '924097',
        '91690',
        '912696',
        '916306',
        '912672',
        '913805',
        '913747',
        '924732',
        '924793',
        '923993',
        '928064',
        '926374',
        '921543',
        '921442',
        '922786',
        '920480',
        '921547',
        '921695',
        '920231',
        '920088',
        '920779',
        '921658')



GROUP BY 
    A.DRIVER_ID, A.ZONE_CODE, RAC_HOURS_WORKED, RAC_ORDERS_DELIVERED, CITY_NAME

ORDER BY 
  A.DRIVER_ID DESC, CITY_NAME, A.ZONE_CODE
;  